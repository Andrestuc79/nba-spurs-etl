[0m22:05:56.755438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729346ca21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729346dd7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729346d6cec0>]}


============================== 22:05:56.762215 | c48c58a2-fa5f-4090-a97f-e8319634b2c9 ==============================
[0m22:05:56.762215 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:05:56.763684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.459586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c48c58a2-fa5f-4090-a97f-e8319634b2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729347094da0>]}
[0m22:05:57.603537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c48c58a2-fa5f-4090-a97f-e8319634b2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72934612f110>]}
[0m22:05:57.605194 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:05:57.619056 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:05:57.634401 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:57.635434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c48c58a2-fa5f-4090-a97f-e8319634b2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729346153e60>]}
[0m22:05:59.314482 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spurs_dbt.home_vs_away' (models/spurs_analysis/home_vs_away.sql) depends on a node named 'spurs_games' in package or project 'raw' which was not found
[0m22:05:59.318674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729346cceff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7293455817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7293459b1a30>]}
[0m22:05:59.320449 [debug] [MainThread]: Flushing usage events
[0m22:27:21.548870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcb04ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcb04e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcb04fef0>]}


============================== 22:27:21.555228 | 610c7a7b-23d6-4bc2-9a9a-ff3446bb5acf ==============================
[0m22:27:21.555228 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:27:21.556638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:27:21.846732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '610c7a7b-23d6-4bc2-9a9a-ff3446bb5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcb3d2f90>]}
[0m22:27:21.969979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '610c7a7b-23d6-4bc2-9a9a-ff3446bb5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcdb126c0>]}
[0m22:27:21.971430 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:27:21.983840 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:27:21.994622 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:27:21.995564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '610c7a7b-23d6-4bc2-9a9a-ff3446bb5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bca302420>]}
[0m22:27:23.129118 [error] [MainThread]: Encountered an error:
Compilation Error in model top_players_by_metric (models/spurs_analysis/top_players_by_metric.sql)
  source() takes exactly two arguments (1 given)
[0m22:27:23.131592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcb43d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bc9f93aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bc9b99ca0>]}
[0m22:27:23.132538 [debug] [MainThread]: Flushing usage events
[0m22:32:12.469028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a062aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a06295b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a062b080>]}


============================== 22:32:12.476050 | 76df2b90-bf45-4923-a44d-14ef829d30de ==============================
[0m22:32:12.476050 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:32:12.477769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:32:12.754111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76df2b90-bf45-4923-a44d-14ef829d30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a192b800>]}
[0m22:32:12.867255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76df2b90-bf45-4923-a44d-14ef829d30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72369f53b560>]}
[0m22:32:12.868765 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:32:12.880185 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:32:12.893758 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:32:12.894775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76df2b90-bf45-4923-a44d-14ef829d30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72369f564980>]}
[0m22:32:14.543694 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spurs_dbt.home_vs_away' (models/spurs_analysis/home_vs_away.sql) depends on a source named 'raw.spurs_games' which was not found
[0m22:32:14.545711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a0a1bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72369f14c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72369f1616d0>]}
[0m22:32:14.546745 [debug] [MainThread]: Flushing usage events
[0m22:37:53.867114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669e369b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669fb59a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669e369a60>]}


============================== 22:37:53.873941 | 3def9f8a-72f6-45fa-a9e7-652290d2665d ==============================
[0m22:37:53.873941 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:37:53.875267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:37:54.158972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669e3c68a0>]}
[0m22:37:54.572006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669e49fc20>]}
[0m22:37:54.573589 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:37:54.584426 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:37:54.598621 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:37:54.599593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669dbf3c50>]}
[0m22:37:56.681330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m22:37:56.689106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669c3086e0>]}
[0m22:37:56.759734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669cb44f50>]}
[0m22:37:56.760858 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m22:37:56.761981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669cf46f60>]}
[0m22:37:56.764849 [info ] [MainThread]: 
[0m22:37:56.766312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:56.768702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m22:37:56.783920 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m22:37:56.785041 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m22:37:56.785980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:56.797377 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:37:56.799608 [debug] [ThreadPool]: On list_nba: Close
[0m22:37:56.803017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m22:37:56.814356 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m22:37:56.815542 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m22:37:56.816540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:56.824433 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:37:56.825640 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m22:37:56.826788 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:37:56.852419 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:37:56.855747 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m22:37:56.857371 [debug] [ThreadPool]: On list_nba_raw: Close
[0m22:37:56.864156 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:56.865209 [debug] [MainThread]: On master: BEGIN
[0m22:37:56.866434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:56.873981 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:56.875200 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:56.876359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:37:56.893849 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:37:56.895938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669ecae8d0>]}
[0m22:37:56.896929 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:56.898126 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:56.899119 [debug] [MainThread]: On master: BEGIN
[0m22:37:56.900662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:56.901913 [debug] [MainThread]: On master: COMMIT
[0m22:37:56.902987 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:56.904227 [debug] [MainThread]: On master: COMMIT
[0m22:37:56.905915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:37:56.907064 [debug] [MainThread]: On master: Close
[0m22:37:56.908706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:37:56.909829 [info ] [MainThread]: 
[0m22:37:56.915303 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m22:37:56.916757 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.home_vs_away ................................... [RUN]
[0m22:37:56.918714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m22:37:56.919807 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m22:37:56.929370 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m22:37:56.966899 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 22:37:56.920726 => 22:37:56.966467
[0m22:37:56.967888 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m22:37:57.017785 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m22:37:57.052478 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:37:57.054076 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m22:37:57.055858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:57.062368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:57.063388 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:37:57.064273 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  create view "nba"."raw"."home_vs_away__dbt_tmp"
    
    
  as (
    with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location;
  );
[0m22:37:57.065986 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: order by season, location;
                                  ^

[0m22:37:57.067175 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: ROLLBACK
[0m22:37:57.068670 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 22:37:56.968606 => 22:37:57.068356
[0m22:37:57.069650 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m22:37:57.080065 [debug] [Thread-1 (]: Database Error in model home_vs_away (models/spurs_analysis/home_vs_away.sql)
  syntax error at or near ";"
  LINE 28: order by season, location;
                                    ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/home_vs_away.sql
[0m22:37:57.081240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669cb3cb60>]}
[0m22:37:57.082581 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model raw.home_vs_away .......................... [[31mERROR[0m in 0.16s]
[0m22:37:57.083882 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m22:37:57.084950 [debug] [Thread-1 (]: Began running node model.spurs_dbt.spurs_games
[0m22:37:57.086784 [info ] [Thread-1 (]: 2 of 4 START sql view model raw.spurs_games .................................... [RUN]
[0m22:37:57.089537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.spurs_games)
[0m22:37:57.091276 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.spurs_games
[0m22:37:57.094111 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.spurs_games"
[0m22:37:57.110734 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.spurs_games (compile): 22:37:57.092110 => 22:37:57.110302
[0m22:37:57.111765 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.spurs_games
[0m22:37:57.117713 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.spurs_games"
[0m22:37:57.133202 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.spurs_games"
[0m22:37:57.133993 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: BEGIN
[0m22:37:57.134798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:57.141904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:57.143186 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.spurs_games"
[0m22:37:57.144148 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.spurs_games"} */

  create view "nba"."raw"."spurs_games__dbt_tmp"
    
    
  as (
    version: 2
sources:
  - name: raw
    tables:
      - name: spurs_games
  );
[0m22:37:57.145693 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m22:37:57.146739 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: ROLLBACK
[0m22:37:57.148151 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.spurs_games (execute): 22:37:57.112616 => 22:37:57.147849
[0m22:37:57.149170 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: Close
[0m22:37:57.153244 [debug] [Thread-1 (]: Database Error in model spurs_games (models/spurs_analysis/spurs_games.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/spurs_games.sql
[0m22:37:57.155064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669c3334a0>]}
[0m22:37:57.156556 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model raw.spurs_games ........................... [[31mERROR[0m in 0.07s]
[0m22:37:57.157869 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.spurs_games
[0m22:37:57.159158 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m22:37:57.160202 [info ] [Thread-1 (]: 3 of 4 START sql view model raw.summary_by_season .............................. [RUN]
[0m22:37:57.161635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.spurs_games, now model.spurs_dbt.summary_by_season)
[0m22:37:57.162616 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m22:37:57.168147 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m22:37:57.187362 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 22:37:57.163427 => 22:37:57.186539
[0m22:37:57.189174 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m22:37:57.195063 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m22:37:57.210799 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m22:37:57.211690 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m22:37:57.212485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:57.219025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:57.220383 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m22:37:57.222146 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  create view "nba"."raw"."summary_by_season__dbt_tmp"
    
    
  as (
    with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season;
  );
[0m22:37:57.223760 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: order by season;
                        ^

[0m22:37:57.224758 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: ROLLBACK
[0m22:37:57.226278 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 22:37:57.190289 => 22:37:57.225857
[0m22:37:57.227319 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m22:37:57.231129 [debug] [Thread-1 (]: Database Error in model summary_by_season (models/spurs_analysis/summary_by_season.sql)
  syntax error at or near ";"
  LINE 23: order by season;
                          ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/summary_by_season.sql
[0m22:37:57.232274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669d3cb620>]}
[0m22:37:57.233430 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model raw.summary_by_season ..................... [[31mERROR[0m in 0.07s]
[0m22:37:57.234756 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m22:37:57.235806 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m22:37:57.237365 [info ] [Thread-1 (]: 4 of 4 START sql view model raw.team_weaknesses ................................ [RUN]
[0m22:37:57.239770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m22:37:57.240786 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m22:37:57.244394 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m22:37:57.262799 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 22:37:57.241547 => 22:37:57.262297
[0m22:37:57.263958 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m22:37:57.271707 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m22:37:57.290598 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m22:37:57.291736 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m22:37:57.292769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:57.299935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:57.301092 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m22:37:57.302159 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  create view "nba"."raw"."team_weaknesses__dbt_tmp"
    
    
  as (
    with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season;
  );
[0m22:37:57.304619 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: order by season;
                        ^

[0m22:37:57.306164 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: ROLLBACK
[0m22:37:57.308011 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 22:37:57.264824 => 22:37:57.307649
[0m22:37:57.309120 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m22:37:57.313025 [debug] [Thread-1 (]: Database Error in model team_weaknesses (models/spurs_analysis/team_weaknesses.sql)
  syntax error at or near ";"
  LINE 22: order by season;
                          ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/team_weaknesses.sql
[0m22:37:57.314349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3def9f8a-72f6-45fa-a9e7-652290d2665d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669cb82180>]}
[0m22:37:57.315662 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model raw.team_weaknesses ....................... [[31mERROR[0m in 0.07s]
[0m22:37:57.317070 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m22:37:57.321462 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:57.322918 [debug] [MainThread]: On master: BEGIN
[0m22:37:57.323945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:57.331832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:57.332999 [debug] [MainThread]: On master: COMMIT
[0m22:37:57.334428 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:57.335712 [debug] [MainThread]: On master: COMMIT
[0m22:37:57.338020 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:37:57.339642 [debug] [MainThread]: On master: Close
[0m22:37:57.341504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:57.342760 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m22:37:57.344023 [info ] [MainThread]: 
[0m22:37:57.345280 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m22:37:57.348954 [debug] [MainThread]: Command end result
[0m22:37:57.427349 [info ] [MainThread]: 
[0m22:37:57.428788 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:37:57.430036 [info ] [MainThread]: 
[0m22:37:57.431326 [error] [MainThread]:   Database Error in model home_vs_away (models/spurs_analysis/home_vs_away.sql)
  syntax error at or near ";"
  LINE 28: order by season, location;
                                    ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/home_vs_away.sql
[0m22:37:57.432536 [info ] [MainThread]: 
[0m22:37:57.433642 [error] [MainThread]:   Database Error in model spurs_games (models/spurs_analysis/spurs_games.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/spurs_games.sql
[0m22:37:57.434703 [info ] [MainThread]: 
[0m22:37:57.436099 [error] [MainThread]:   Database Error in model summary_by_season (models/spurs_analysis/summary_by_season.sql)
  syntax error at or near ";"
  LINE 23: order by season;
                          ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/summary_by_season.sql
[0m22:37:57.437662 [info ] [MainThread]: 
[0m22:37:57.439747 [error] [MainThread]:   Database Error in model team_weaknesses (models/spurs_analysis/team_weaknesses.sql)
  syntax error at or near ";"
  LINE 22: order by season;
                          ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/team_weaknesses.sql
[0m22:37:57.441129 [info ] [MainThread]: 
[0m22:37:57.442350 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m22:37:57.444487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669e36bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669d795fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c669d797140>]}
[0m22:37:57.445738 [debug] [MainThread]: Flushing usage events
[0m22:43:22.839160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b596c76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b597366c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b597cad20>]}


============================== 22:43:22.845285 | e202ff32-43f3-4358-abb2-92147838f103 ==============================
[0m22:43:22.845285 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:43:22.846534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:23.163783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b59a5e930>]}
[0m22:43:23.325987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b5969b590>]}
[0m22:43:23.327473 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:43:23.356446 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:43:23.563908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:43:23.565206 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/home_vs_away.sql
[0m22:43:23.566207 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/summary_by_season.sql
[0m22:43:23.567149 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/team_weaknesses.sql
[0m22:43:23.979444 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m22:43:23.986149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b581e8a40>]}
[0m22:43:24.045702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b589d4da0>]}
[0m22:43:24.046761 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m22:43:24.047829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b57d35dc0>]}
[0m22:43:24.050604 [info ] [MainThread]: 
[0m22:43:24.052277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:24.055447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m22:43:24.073897 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m22:43:24.075117 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m22:43:24.076288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:24.087989 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:43:24.091482 [debug] [ThreadPool]: On list_nba: Close
[0m22:43:24.095289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m22:43:24.104079 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m22:43:24.105822 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m22:43:24.107927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:24.115170 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.116293 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m22:43:24.117242 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:43:24.123207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:43:24.125860 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m22:43:24.127548 [debug] [ThreadPool]: On list_nba_raw: Close
[0m22:43:24.137729 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:24.139233 [debug] [MainThread]: On master: BEGIN
[0m22:43:24.141257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:24.149278 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.150410 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:24.151822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:24.163433 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:43:24.166267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b58525310>]}
[0m22:43:24.167873 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:24.169348 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:24.170468 [debug] [MainThread]: On master: BEGIN
[0m22:43:24.172550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.174634 [debug] [MainThread]: On master: COMMIT
[0m22:43:24.175874 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:24.176867 [debug] [MainThread]: On master: COMMIT
[0m22:43:24.178339 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:43:24.179413 [debug] [MainThread]: On master: Close
[0m22:43:24.181294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:24.182383 [info ] [MainThread]: 
[0m22:43:24.188648 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m22:43:24.191133 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.home_vs_away ................................... [RUN]
[0m22:43:24.193274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m22:43:24.194538 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m22:43:24.204447 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m22:43:24.224354 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 22:43:24.195432 => 22:43:24.223954
[0m22:43:24.225332 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m22:43:24.274806 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m22:43:24.360377 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:43:24.361356 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m22:43:24.362312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:24.369405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.370552 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:43:24.371705 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  create view "nba"."raw"."home_vs_away__dbt_tmp"
    
    
  as (
    with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
[0m22:43:24.418173 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:43:24.426845 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:43:24.427947 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m22:43:24.433761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:43:24.457473 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m22:43:24.458884 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:43:24.460173 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m22:43:24.468670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:43:24.479348 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m22:43:24.488547 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:43:24.490196 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop view if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m22:43:24.493258 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:43:24.495994 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 22:43:24.226038 => 22:43:24.495493
[0m22:43:24.497066 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m22:43:24.498668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b5796d7c0>]}
[0m22:43:24.500052 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.home_vs_away .............................. [[32mCREATE VIEW[0m in 0.31s]
[0m22:43:24.501619 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m22:43:24.502776 [debug] [Thread-1 (]: Began running node model.spurs_dbt.spurs_games
[0m22:43:24.504009 [info ] [Thread-1 (]: 2 of 4 START sql view model raw.spurs_games .................................... [RUN]
[0m22:43:24.506247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.spurs_games)
[0m22:43:24.508328 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.spurs_games
[0m22:43:24.511521 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.spurs_games"
[0m22:43:24.530258 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.spurs_games (compile): 22:43:24.509407 => 22:43:24.529868
[0m22:43:24.531122 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.spurs_games
[0m22:43:24.537920 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.spurs_games"
[0m22:43:24.557583 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.spurs_games"
[0m22:43:24.558564 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: BEGIN
[0m22:43:24.559431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:24.566434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.567498 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.spurs_games"
[0m22:43:24.568623 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.spurs_games"} */

  create view "nba"."raw"."spurs_games__dbt_tmp"
    
    
  as (
    version: 2
sources:
  - name: raw
    tables:
      - name: spurs_games
  );
[0m22:43:24.570440 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m22:43:24.571805 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: ROLLBACK
[0m22:43:24.574010 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.spurs_games (execute): 22:43:24.531835 => 22:43:24.573628
[0m22:43:24.575007 [debug] [Thread-1 (]: On model.spurs_dbt.spurs_games: Close
[0m22:43:24.580166 [debug] [Thread-1 (]: Database Error in model spurs_games (models/spurs_analysis/spurs_games.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/spurs_games.sql
[0m22:43:24.581305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b575294c0>]}
[0m22:43:24.582486 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model raw.spurs_games ........................... [[31mERROR[0m in 0.08s]
[0m22:43:24.583841 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.spurs_games
[0m22:43:24.584861 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m22:43:24.586365 [info ] [Thread-1 (]: 3 of 4 START sql view model raw.summary_by_season .............................. [RUN]
[0m22:43:24.587790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.spurs_games, now model.spurs_dbt.summary_by_season)
[0m22:43:24.589196 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m22:43:24.593913 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m22:43:24.613640 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 22:43:24.590699 => 22:43:24.613227
[0m22:43:24.614591 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m22:43:24.619851 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m22:43:24.646448 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m22:43:24.647532 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m22:43:24.648845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:24.658475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.660026 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m22:43:24.661315 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  create view "nba"."raw"."summary_by_season__dbt_tmp"
    
    
  as (
    with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
[0m22:43:24.667519 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:43:24.674116 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m22:43:24.676459 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m22:43:24.678111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:43:24.680822 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m22:43:24.681878 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m22:43:24.682914 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m22:43:24.691553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:43:24.695436 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m22:43:24.697054 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m22:43:24.698112 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop view if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m22:43:24.699522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:43:24.702033 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 22:43:24.615370 => 22:43:24.701763
[0m22:43:24.703350 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m22:43:24.705059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b57529250>]}
[0m22:43:24.707030 [info ] [Thread-1 (]: 3 of 4 OK created sql view model raw.summary_by_season ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m22:43:24.708654 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m22:43:24.709855 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m22:43:24.710931 [info ] [Thread-1 (]: 4 of 4 START sql view model raw.team_weaknesses ................................ [RUN]
[0m22:43:24.712333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m22:43:24.713419 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m22:43:24.717410 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m22:43:24.736980 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 22:43:24.714293 => 22:43:24.736599
[0m22:43:24.737953 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m22:43:24.744120 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m22:43:24.763419 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m22:43:24.764439 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m22:43:24.765279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:24.772877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.774677 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m22:43:24.775934 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  create view "nba"."raw"."team_weaknesses__dbt_tmp"
    
    
  as (
    with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
[0m22:43:24.781045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:43:24.785428 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m22:43:24.786574 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m22:43:24.788869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:43:24.792438 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m22:43:24.793507 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m22:43:24.794453 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m22:43:24.804672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:43:24.809235 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m22:43:24.810758 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m22:43:24.811685 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop view if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m22:43:24.813035 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:43:24.815403 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 22:43:24.738824 => 22:43:24.815120
[0m22:43:24.816540 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m22:43:24.818062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e202ff32-43f3-4358-abb2-92147838f103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b579ab8c0>]}
[0m22:43:24.819283 [info ] [Thread-1 (]: 4 of 4 OK created sql view model raw.team_weaknesses ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m22:43:24.820669 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m22:43:24.824954 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:24.826086 [debug] [MainThread]: On master: BEGIN
[0m22:43:24.827095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:24.834033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:43:24.835063 [debug] [MainThread]: On master: COMMIT
[0m22:43:24.836016 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:24.837356 [debug] [MainThread]: On master: COMMIT
[0m22:43:24.838596 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:43:24.839932 [debug] [MainThread]: On master: Close
[0m22:43:24.841788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:24.842898 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m22:43:24.844118 [info ] [MainThread]: 
[0m22:43:24.845218 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m22:43:24.846958 [debug] [MainThread]: Command end result
[0m22:43:24.904385 [info ] [MainThread]: 
[0m22:43:24.906216 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:43:24.907741 [info ] [MainThread]: 
[0m22:43:24.908728 [error] [MainThread]:   Database Error in model spurs_games (models/spurs_analysis/spurs_games.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled Code at target/run/spurs_dbt/models/spurs_analysis/spurs_games.sql
[0m22:43:24.910204 [info ] [MainThread]: 
[0m22:43:24.911028 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:43:24.912605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b59cb5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b57553050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1b57553d70>]}
[0m22:43:24.913608 [debug] [MainThread]: Flushing usage events
[0m22:50:15.837924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a59a5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a59a60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a59a5d30>]}


============================== 22:50:15.842929 | c3995ba4-4c4f-438d-8ba0-7ea510923f20 ==============================
[0m22:50:15.842929 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:50:15.844400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:50:16.131984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3995ba4-4c4f-438d-8ba0-7ea510923f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a59a66c0>]}
[0m22:50:16.247578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3995ba4-4c4f-438d-8ba0-7ea510923f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a5af8290>]}
[0m22:50:16.249082 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:50:16.274261 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:50:16.523756 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m22:50:16.524815 [debug] [MainThread]: Partial parsing: deleted file: spurs_dbt://models/spurs_analysis/spurs_games.sql
[0m22:50:16.525892 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/home_vs_away.sql
[0m22:50:16.527217 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/team_weaknesses.sql
[0m22:50:16.529165 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/summary_by_season.sql
[0m22:50:16.683392 [error] [MainThread]: Encountered an error:
Compilation Error in model home_vs_away (models/spurs_analysis/home_vs_away.sql)
  expected token 'end of print statement', got 'with'
    line 2
      with base as (
[0m22:50:16.685379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a59a6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a516efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468a4912e10>]}
[0m22:50:16.686500 [debug] [MainThread]: Flushing usage events
[0m22:56:20.387893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7402174bd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7402174be060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7402174bd850>]}


============================== 22:56:20.394344 | 66564152-fff6-49ac-9cdb-5708ceb3f58e ==============================
[0m22:56:20.394344 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:56:20.395747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:56:20.728774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66564152-fff6-49ac-9cdb-5708ceb3f58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7402174be750>]}
[0m22:56:20.894999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66564152-fff6-49ac-9cdb-5708ceb3f58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74021787e7e0>]}
[0m22:56:20.896514 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:56:20.921824 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:56:21.172640 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m22:56:21.174588 [debug] [MainThread]: Partial parsing: deleted file: spurs_dbt://models/spurs_analysis/spurs_games.sql
[0m22:56:21.176220 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/summary_by_season.sql
[0m22:56:21.177680 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/team_weaknesses.sql
[0m22:56:21.179412 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/home_vs_away.sql
[0m22:56:21.570504 [error] [MainThread]: Encountered an error:
Compilation Error in model team_weaknesses (models/spurs_analysis/team_weaknesses.sql)
  expected token 'end of print statement', got 'with'
    line 3
      with base as (
[0m22:56:21.578897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74021bddaf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740215f5f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740215f5e1b0>]}
[0m22:56:21.581065 [debug] [MainThread]: Flushing usage events
[0m22:59:58.203395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8030cd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db806901d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8031fe5a0>]}


============================== 22:59:58.208517 | dfedd7d6-80ec-4c16-bc5a-bed53c2aff15 ==============================
[0m22:59:58.208517 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:59:58.209711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:58.830737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db802776960>]}
[0m22:59:58.944279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db802f2db80>]}
[0m22:59:58.946762 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m22:59:58.986398 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:59:59.190738 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m22:59:59.191985 [debug] [MainThread]: Partial parsing: deleted file: spurs_dbt://models/spurs_analysis/spurs_games.sql
[0m22:59:59.193113 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/team_weaknesses.sql
[0m22:59:59.194677 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/home_vs_away.sql
[0m22:59:59.196733 [debug] [MainThread]: Partial parsing: updated file: spurs_dbt://models/spurs_analysis/summary_by_season.sql
[0m22:59:59.613407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m22:59:59.621459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db80171a0c0>]}
[0m22:59:59.680139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8023b0bc0>]}
[0m22:59:59.681271 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m22:59:59.682362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db80177ebd0>]}
[0m22:59:59.685651 [info ] [MainThread]: 
[0m22:59:59.687265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:59:59.689975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m22:59:59.707464 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m22:59:59.708474 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m22:59:59.709933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:59.720494 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:59:59.722744 [debug] [ThreadPool]: On list_nba: Close
[0m22:59:59.727012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m22:59:59.735931 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m22:59:59.737107 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m22:59:59.738230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:59.746288 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:59:59.747745 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m22:59:59.748635 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:59:59.754057 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:59:59.757346 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m22:59:59.758985 [debug] [ThreadPool]: On list_nba_raw: Close
[0m22:59:59.770200 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:59.771559 [debug] [MainThread]: On master: BEGIN
[0m22:59:59.772752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:59.782109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:59:59.783141 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:59.784138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:59:59.797999 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:59:59.800679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db803806930>]}
[0m22:59:59.801821 [debug] [MainThread]: On master: ROLLBACK
[0m22:59:59.805885 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:59.806868 [debug] [MainThread]: On master: BEGIN
[0m22:59:59.808329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:59:59.809478 [debug] [MainThread]: On master: COMMIT
[0m22:59:59.810458 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:59.811590 [debug] [MainThread]: On master: COMMIT
[0m22:59:59.813676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:59:59.814796 [debug] [MainThread]: On master: Close
[0m22:59:59.816337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:59:59.818044 [info ] [MainThread]: 
[0m22:59:59.824657 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m22:59:59.826237 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m22:59:59.828035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m22:59:59.829763 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m22:59:59.839501 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m22:59:59.857787 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 22:59:59.830923 => 22:59:59.857385
[0m22:59:59.858843 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m22:59:59.908450 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m22:59:59.930259 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:59:59.931353 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m22:59:59.932378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:59.939489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:59:59.940618 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:59:59.941553 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m22:59:59.968196 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m22:59:59.977052 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m22:59:59.978840 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m22:59:59.981016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:00.005679 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:00:00.006836 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:00:00.007807 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:00:00.013568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:00.022529 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m23:00:00.031973 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:00:00.033319 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m23:00:00.035038 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:00:00.037826 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 22:59:59.859651 => 23:00:00.037505
[0m23:00:00.038920 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m23:00:00.040680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db80138b740>]}
[0m23:00:00.041955 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.21s]
[0m23:00:00.043537 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m23:00:00.044960 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m23:00:00.046685 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m23:00:00.048147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m23:00:00.049283 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m23:00:00.055025 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m23:00:00.074401 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 23:00:00.050081 => 23:00:00.073980
[0m23:00:00.075362 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m23:00:00.081524 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m23:00:00.100359 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:00:00.101418 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m23:00:00.102330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:00.110122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:00.111518 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:00:00.113168 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m23:00:00.130829 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m23:00:00.135291 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:00:00.136426 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m23:00:00.137950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:00.140615 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:00:00.141750 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:00:00.142795 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:00:00.148883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:00.152803 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m23:00:00.154254 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:00:00.155266 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m23:00:00.156855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:00:00.159184 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 23:00:00.076105 => 23:00:00.158909
[0m23:00:00.160454 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m23:00:00.162634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8013f3230>]}
[0m23:00:00.164293 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.11s]
[0m23:00:00.165921 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m23:00:00.167143 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m23:00:00.168475 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m23:00:00.169895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m23:00:00.170984 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m23:00:00.175077 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m23:00:00.194222 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 23:00:00.171862 => 23:00:00.193827
[0m23:00:00.195926 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m23:00:00.201415 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m23:00:00.220121 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:00:00.221049 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m23:00:00.221901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:00.228687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:00.230196 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:00:00.231255 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m23:00:00.246539 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m23:00:00.250973 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:00:00.252122 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m23:00:00.253663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:00:00.256299 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:00:00.257547 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:00:00.258645 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:00:00.264529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:00:00.268689 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m23:00:00.270178 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:00:00.271142 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m23:00:00.272522 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:00:00.274894 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 23:00:00.196917 => 23:00:00.274598
[0m23:00:00.276410 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m23:00:00.278520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfedd7d6-80ec-4c16-bc5a-bed53c2aff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8013cd3d0>]}
[0m23:00:00.281473 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.11s]
[0m23:00:00.282882 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m23:00:00.286003 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:00.286884 [debug] [MainThread]: On master: BEGIN
[0m23:00:00.287598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:00.294275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:00.295755 [debug] [MainThread]: On master: COMMIT
[0m23:00:00.297005 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:00.298082 [debug] [MainThread]: On master: COMMIT
[0m23:00:00.299305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:00.300263 [debug] [MainThread]: On master: Close
[0m23:00:00.301876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:00.302821 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m23:00:00.303831 [info ] [MainThread]: 
[0m23:00:00.304868 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m23:00:00.306733 [debug] [MainThread]: Command end result
[0m23:00:00.360258 [info ] [MainThread]: 
[0m23:00:00.362476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:00.364316 [info ] [MainThread]: 
[0m23:00:00.365765 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:00:00.367948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8079eaf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8013179b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db801b837d0>]}
[0m23:00:00.369377 [debug] [MainThread]: Flushing usage events
[0m23:11:10.271464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4681c03650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4681c00950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4681c00350>]}


============================== 23:11:10.277667 | 3d336d45-61ed-4de7-a4b2-8c5bccf1c060 ==============================
[0m23:11:10.277667 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:11:10.279602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:11:10.743360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4681a97d70>]}
[0m23:11:10.884174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4681aaebd0>]}
[0m23:11:10.885771 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m23:11:10.913819 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:11:11.141334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:11:11.142514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:11:11.143818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m23:11:11.153331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4680b23e00>]}
[0m23:11:11.214317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4680bbdd00>]}
[0m23:11:11.216671 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:11:11.218056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4680bbd520>]}
[0m23:11:11.221376 [info ] [MainThread]: 
[0m23:11:11.223427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:11.227209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m23:11:11.245421 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m23:11:11.247143 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m23:11:11.249313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:11.260218 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:11:11.262702 [debug] [ThreadPool]: On list_nba: Close
[0m23:11:11.267507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m23:11:11.278183 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:11:11.279565 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m23:11:11.281355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:11.289743 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:11:11.290915 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:11:11.291981 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m23:11:11.297384 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:11:11.300305 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m23:11:11.301979 [debug] [ThreadPool]: On list_nba_raw: Close
[0m23:11:11.311759 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:11.312975 [debug] [MainThread]: On master: BEGIN
[0m23:11:11.314271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:11.322042 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:11.323170 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:11.324287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:11.344771 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:11:11.348580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4681c032c0>]}
[0m23:11:11.350100 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:11.351658 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:11.352545 [debug] [MainThread]: On master: BEGIN
[0m23:11:11.354217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:11.355225 [debug] [MainThread]: On master: COMMIT
[0m23:11:11.356200 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:11.357454 [debug] [MainThread]: On master: COMMIT
[0m23:11:11.359064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:11.360210 [debug] [MainThread]: On master: Close
[0m23:11:11.361855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:11:11.362947 [info ] [MainThread]: 
[0m23:11:11.369329 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m23:11:11.370634 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m23:11:11.372017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m23:11:11.372927 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m23:11:11.385444 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m23:11:11.400570 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 23:11:11.373561 => 23:11:11.400148
[0m23:11:11.401446 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m23:11:11.458139 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m23:11:11.474261 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:11:11.475208 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m23:11:11.476061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:11.483739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:11.484856 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:11:11.485992 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m23:11:11.507995 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m23:11:11.517966 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:11:11.519100 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m23:11:11.520744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:11:11.525101 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:11:11.526023 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m23:11:11.527471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:11:11.557089 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:11:11.558098 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:11:11.559034 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:11:11.566396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:11:11.575273 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m23:11:11.586301 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:11:11.587466 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m23:11:11.595881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:11:11.599702 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 23:11:11.402103 => 23:11:11.599380
[0m23:11:11.600765 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m23:11:11.602350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4680b6e9c0>]}
[0m23:11:11.603542 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.23s]
[0m23:11:11.604873 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m23:11:11.606123 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m23:11:11.607132 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m23:11:11.608501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m23:11:11.609421 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m23:11:11.614506 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m23:11:11.633926 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 23:11:11.610237 => 23:11:11.633415
[0m23:11:11.634974 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m23:11:11.640645 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m23:11:11.658463 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:11:11.659457 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m23:11:11.660377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:11.668499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:11.669597 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:11:11.670668 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m23:11:11.687428 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m23:11:11.692036 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:11:11.693110 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m23:11:11.694632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:11:11.700841 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:11:11.702165 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m23:11:11.703772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:11:11.706970 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:11:11.708059 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:11:11.709027 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:11:11.714948 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:11:11.719356 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m23:11:11.721015 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:11:11.722168 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m23:11:11.729073 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:11:11.732711 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 23:11:11.635779 => 23:11:11.732319
[0m23:11:11.734012 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m23:11:11.736107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a468036df40>]}
[0m23:11:11.739936 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.13s]
[0m23:11:11.742138 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m23:11:11.743678 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m23:11:11.745158 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m23:11:11.747252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m23:11:11.748917 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m23:11:11.754081 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m23:11:11.772800 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 23:11:11.750105 => 23:11:11.772344
[0m23:11:11.774646 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m23:11:11.782708 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m23:11:11.801775 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:11:11.802954 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m23:11:11.804143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:11.811838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:11.813014 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:11:11.814315 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m23:11:11.833635 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m23:11:11.840401 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:11:11.841569 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m23:11:11.843116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:11:11.847816 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:11:11.848981 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m23:11:11.850601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:11:11.854452 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:11:11.856203 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:11:11.857252 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:11:11.863060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:11:11.867724 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m23:11:11.869366 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:11:11.870387 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m23:11:11.876809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:11:11.879724 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 23:11:11.775957 => 23:11:11.879419
[0m23:11:11.881055 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m23:11:11.882817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d336d45-61ed-4de7-a4b2-8c5bccf1c060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46803baf90>]}
[0m23:11:11.885804 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.14s]
[0m23:11:11.887371 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m23:11:11.890989 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:11.892057 [debug] [MainThread]: On master: BEGIN
[0m23:11:11.893163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:11.900533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:11.901607 [debug] [MainThread]: On master: COMMIT
[0m23:11:11.902662 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:11.903544 [debug] [MainThread]: On master: COMMIT
[0m23:11:11.904804 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:11.905888 [debug] [MainThread]: On master: Close
[0m23:11:11.907504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:11.908509 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m23:11:11.910012 [info ] [MainThread]: 
[0m23:11:11.911167 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m23:11:11.913209 [debug] [MainThread]: Command end result
[0m23:11:11.980478 [info ] [MainThread]: 
[0m23:11:11.981908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:11.983208 [info ] [MainThread]: 
[0m23:11:11.984471 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:11:11.986595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46841ce240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a468037fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46803a39b0>]}
[0m23:11:11.987956 [debug] [MainThread]: Flushing usage events
[0m23:13:36.251826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf6f3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb1e2d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf6f27b0>]}


============================== 23:13:36.262350 | 969768b6-1622-4a10-ba5a-405246026f06 ==============================
[0m23:13:36.262350 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:13:36.266261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:13:36.649120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf6f3350>]}
[0m23:13:36.768985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf5ebf80>]}
[0m23:13:36.770888 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m23:13:36.796765 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:13:36.987407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:13:36.988424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:36.989706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m23:13:36.996584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaedc1b80>]}
[0m23:13:37.069710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccae9d5b80>]}
[0m23:13:37.070886 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:13:37.072594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb052a930>]}
[0m23:13:37.075484 [info ] [MainThread]: 
[0m23:13:37.077035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:13:37.079692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m23:13:37.097851 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m23:13:37.098925 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m23:13:37.099919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:37.110787 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:13:37.113184 [debug] [ThreadPool]: On list_nba: Close
[0m23:13:37.117026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m23:13:37.126940 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:13:37.127978 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m23:13:37.128891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:37.135722 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.136989 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:13:37.138002 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m23:13:37.143241 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:13:37.145804 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m23:13:37.147357 [debug] [ThreadPool]: On list_nba_raw: Close
[0m23:13:37.156445 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.157678 [debug] [MainThread]: On master: BEGIN
[0m23:13:37.158924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:37.165918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.167018 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.168069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:13:37.181600 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:13:37.183644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccae93b860>]}
[0m23:13:37.184768 [debug] [MainThread]: On master: ROLLBACK
[0m23:13:37.186203 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.187157 [debug] [MainThread]: On master: BEGIN
[0m23:13:37.188844 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.189929 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.190875 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.191805 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.193087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:13:37.194241 [debug] [MainThread]: On master: Close
[0m23:13:37.195737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:37.197218 [info ] [MainThread]: 
[0m23:13:37.203125 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m23:13:37.204369 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m23:13:37.205846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m23:13:37.206862 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m23:13:37.217039 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m23:13:37.242803 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 23:13:37.207700 => 23:13:37.242409
[0m23:13:37.243802 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m23:13:37.290073 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m23:13:37.316244 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:13:37.317252 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m23:13:37.318218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:37.325568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.326620 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:13:37.327543 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m23:13:37.349559 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m23:13:37.357754 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:13:37.358842 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m23:13:37.360245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:37.364360 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:13:37.365389 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m23:13:37.366795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:37.391986 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:13:37.393238 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:13:37.394344 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:13:37.402238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:13:37.411835 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m23:13:37.419269 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:13:37.420763 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m23:13:37.432132 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:13:37.435342 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 23:13:37.244631 => 23:13:37.434716
[0m23:13:37.437097 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m23:13:37.438867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf5cade0>]}
[0m23:13:37.440115 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.23s]
[0m23:13:37.441715 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m23:13:37.442895 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m23:13:37.443960 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m23:13:37.445460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m23:13:37.446414 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m23:13:37.450601 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m23:13:37.478247 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 23:13:37.447166 => 23:13:37.477857
[0m23:13:37.479244 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m23:13:37.484869 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m23:13:37.510779 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:13:37.511886 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m23:13:37.512862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:37.520845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.521935 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:13:37.522923 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m23:13:37.539683 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m23:13:37.544091 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:13:37.545285 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m23:13:37.546901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:37.551029 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:13:37.552224 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m23:13:37.553887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:37.556707 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:13:37.557735 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:13:37.558740 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:13:37.564888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:13:37.568682 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m23:13:37.570243 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:13:37.571248 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m23:13:37.578214 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:13:37.580809 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 23:13:37.480008 => 23:13:37.580450
[0m23:13:37.581839 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m23:13:37.583423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccae187290>]}
[0m23:13:37.584709 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.14s]
[0m23:13:37.586075 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m23:13:37.587347 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m23:13:37.588414 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m23:13:37.589915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m23:13:37.590814 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m23:13:37.594955 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m23:13:37.626349 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 23:13:37.591530 => 23:13:37.625537
[0m23:13:37.627944 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m23:13:37.634143 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m23:13:37.660280 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:13:37.661568 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m23:13:37.662596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:37.669934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.671069 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:13:37.672135 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m23:13:37.689010 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m23:13:37.694986 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:13:37.695995 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m23:13:37.697915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:37.702432 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:13:37.703595 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m23:13:37.705148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:37.708073 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:13:37.709091 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:13:37.710205 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:13:37.716233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:13:37.720491 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m23:13:37.722064 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:13:37.722991 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m23:13:37.731547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:13:37.734315 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 23:13:37.628937 => 23:13:37.733854
[0m23:13:37.735853 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m23:13:37.737514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '969768b6-1622-4a10-ba5a-405246026f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccae1a13a0>]}
[0m23:13:37.738761 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.15s]
[0m23:13:37.740171 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m23:13:37.743976 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.745089 [debug] [MainThread]: On master: BEGIN
[0m23:13:37.746119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:37.753025 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.754285 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.755260 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.756202 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.757464 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:13:37.758454 [debug] [MainThread]: On master: Close
[0m23:13:37.759869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:37.760735 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m23:13:37.761754 [info ] [MainThread]: 
[0m23:13:37.762714 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m23:13:37.764411 [debug] [MainThread]: Command end result
[0m23:13:37.832611 [info ] [MainThread]: 
[0m23:13:37.833813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:37.834937 [info ] [MainThread]: 
[0m23:13:37.836419 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:13:37.838341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf5cade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf80e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf80dc70>]}
[0m23:13:37.839656 [debug] [MainThread]: Flushing usage events
[0m23:25:41.311975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741307b12c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741307ae6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741308355820>]}


============================== 23:25:41.322620 | ef086e7f-0b8f-4a15-b286-237dba77a46e ==============================
[0m23:25:41.322620 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:25:41.325154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:25:41.784525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7413071220f0>]}
[0m23:25:41.925463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7413075c67b0>]}
[0m23:25:41.928707 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m23:25:41.957522 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:25:42.156182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:25:42.157366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:25:42.162213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m23:25:42.173699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741306d3ee40>]}
[0m23:25:42.233879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741306dd9d00>]}
[0m23:25:42.234988 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:25:42.236219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741307791ac0>]}
[0m23:25:42.239333 [info ] [MainThread]: 
[0m23:25:42.241216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:25:42.244913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m23:25:42.266615 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m23:25:42.268152 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m23:25:42.269222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:42.281611 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:25:42.284570 [debug] [ThreadPool]: On list_nba: Close
[0m23:25:42.288513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m23:25:42.299914 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:25:42.300943 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m23:25:42.301870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:42.310540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:25:42.312105 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:25:42.313289 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m23:25:42.318984 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:25:42.321342 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m23:25:42.322708 [debug] [ThreadPool]: On list_nba_raw: Close
[0m23:25:42.332738 [debug] [MainThread]: Using postgres connection "master"
[0m23:25:42.334261 [debug] [MainThread]: On master: BEGIN
[0m23:25:42.335762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:42.343913 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:25:42.345316 [debug] [MainThread]: Using postgres connection "master"
[0m23:25:42.346254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:25:42.361410 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:25:42.363443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741306dd9e20>]}
[0m23:25:42.364605 [debug] [MainThread]: On master: ROLLBACK
[0m23:25:42.365705 [debug] [MainThread]: Using postgres connection "master"
[0m23:25:42.366640 [debug] [MainThread]: On master: BEGIN
[0m23:25:42.368261 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:25:42.369317 [debug] [MainThread]: On master: COMMIT
[0m23:25:42.370235 [debug] [MainThread]: Using postgres connection "master"
[0m23:25:42.371087 [debug] [MainThread]: On master: COMMIT
[0m23:25:42.372182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:25:42.372962 [debug] [MainThread]: On master: Close
[0m23:25:42.374242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:25:42.375314 [info ] [MainThread]: 
[0m23:25:42.381335 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m23:25:42.382623 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m23:25:42.384338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m23:25:42.385316 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m23:25:42.396071 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m23:25:42.412320 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 23:25:42.386096 => 23:25:42.411688
[0m23:25:42.414187 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m23:25:42.474606 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m23:25:42.488631 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:25:42.489430 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m23:25:42.490122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:42.497294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:25:42.498455 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:25:42.499330 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m23:25:42.519692 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m23:25:42.528388 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:25:42.529556 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m23:25:42.531216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:25:42.535357 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:25:42.536453 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m23:25:42.537941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:25:42.564815 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:25:42.565955 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:25:42.566814 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:25:42.574484 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:25:42.584102 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m23:25:42.591919 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:25:42.593476 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m23:25:42.600255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:25:42.602737 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 23:25:42.417573 => 23:25:42.602446
[0m23:25:42.603777 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m23:25:42.605213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741306538500>]}
[0m23:25:42.606406 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.22s]
[0m23:25:42.608117 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m23:25:42.610031 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m23:25:42.611728 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m23:25:42.613082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m23:25:42.613958 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m23:25:42.618038 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m23:25:42.634322 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 23:25:42.614680 => 23:25:42.633923
[0m23:25:42.635236 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m23:25:42.640503 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m23:25:42.656029 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:25:42.656917 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m23:25:42.657744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:42.664895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:25:42.665834 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:25:42.666708 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m23:25:42.681402 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m23:25:42.686497 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:25:42.687688 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m23:25:42.689231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:25:42.694481 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:25:42.695641 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m23:25:42.697097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:25:42.700002 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:25:42.700893 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:25:42.701724 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:25:42.709544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:25:42.713800 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m23:25:42.715112 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:25:42.716068 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m23:25:42.722124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:25:42.725065 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 23:25:42.635971 => 23:25:42.724667
[0m23:25:42.726356 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m23:25:42.728158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741306537ef0>]}
[0m23:25:42.729382 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.12s]
[0m23:25:42.730905 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m23:25:42.731980 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m23:25:42.732984 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m23:25:42.734307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m23:25:42.735179 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m23:25:42.739053 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m23:25:42.755102 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 23:25:42.735880 => 23:25:42.754709
[0m23:25:42.756158 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m23:25:42.762368 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m23:25:42.777445 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:25:42.778388 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m23:25:42.779206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:42.785646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:25:42.786578 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:25:42.787444 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m23:25:42.803105 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m23:25:42.812559 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:25:42.813782 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m23:25:42.815437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:25:42.820459 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:25:42.821549 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m23:25:42.823146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:25:42.826675 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:25:42.828108 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:25:42.829104 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:25:42.834822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:25:42.838488 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m23:25:42.840049 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:25:42.841044 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m23:25:42.850788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:25:42.853450 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 23:25:42.756809 => 23:25:42.853175
[0m23:25:42.854500 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m23:25:42.856101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef086e7f-0b8f-4a15-b286-237dba77a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7413065a68d0>]}
[0m23:25:42.858700 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.12s]
[0m23:25:42.860899 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m23:25:42.863818 [debug] [MainThread]: Using postgres connection "master"
[0m23:25:42.864768 [debug] [MainThread]: On master: BEGIN
[0m23:25:42.865582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:25:42.872088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:25:42.873073 [debug] [MainThread]: On master: COMMIT
[0m23:25:42.874003 [debug] [MainThread]: Using postgres connection "master"
[0m23:25:42.875121 [debug] [MainThread]: On master: COMMIT
[0m23:25:42.877138 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:25:42.878357 [debug] [MainThread]: On master: Close
[0m23:25:42.880373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:42.881765 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m23:25:42.882916 [info ] [MainThread]: 
[0m23:25:42.883906 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m23:25:42.885621 [debug] [MainThread]: Command end result
[0m23:25:42.937190 [info ] [MainThread]: 
[0m23:25:42.938299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:25:42.939252 [info ] [MainThread]: 
[0m23:25:42.940200 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:25:42.941818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741307767290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741309ea1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74130659be90>]}
[0m23:25:42.942887 [debug] [MainThread]: Flushing usage events
[0m23:31:28.129170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b783a13080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b783a5de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b783a12ed0>]}


============================== 23:31:28.134251 | 71fd83cf-8532-4928-b0cb-5787e85ea7da ==============================
[0m23:31:28.134251 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:31:28.135592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:28.418985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b783dbbc80>]}
[0m23:31:28.531480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7838d3830>]}
[0m23:31:28.532878 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m23:31:28.558568 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:31:28.778534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:28.780439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:28.782510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m23:31:28.791844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b783dd4920>]}
[0m23:31:28.845065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7829d60c0>]}
[0m23:31:28.846090 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:31:28.846978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b782d92e40>]}
[0m23:31:28.849546 [info ] [MainThread]: 
[0m23:31:28.850910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:28.853058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m23:31:28.866876 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m23:31:28.867950 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m23:31:28.868907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:28.879155 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:31:28.881378 [debug] [ThreadPool]: On list_nba: Close
[0m23:31:28.884610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m23:31:28.894185 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:31:28.895357 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m23:31:28.896350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:28.903434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:31:28.904577 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:31:28.905559 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m23:31:28.911684 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:31:28.913854 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m23:31:28.915149 [debug] [ThreadPool]: On list_nba_raw: Close
[0m23:31:28.922508 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:28.923652 [debug] [MainThread]: On master: BEGIN
[0m23:31:28.925190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:28.931856 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:31:28.932863 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:28.933923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:31:28.946192 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:31:28.948329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b782d90920>]}
[0m23:31:28.949372 [debug] [MainThread]: On master: ROLLBACK
[0m23:31:28.950656 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:28.951625 [debug] [MainThread]: On master: BEGIN
[0m23:31:28.953397 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:31:28.954337 [debug] [MainThread]: On master: COMMIT
[0m23:31:28.955389 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:28.956242 [debug] [MainThread]: On master: COMMIT
[0m23:31:28.957871 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:31:28.958898 [debug] [MainThread]: On master: Close
[0m23:31:28.960285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:31:28.961267 [info ] [MainThread]: 
[0m23:31:28.965348 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m23:31:28.966488 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m23:31:28.967872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m23:31:28.968814 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m23:31:28.978837 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m23:31:28.997882 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 23:31:28.969653 => 23:31:28.997461
[0m23:31:28.998826 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m23:31:29.052124 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m23:31:29.074036 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:31:29.075588 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m23:31:29.076551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:29.083281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:31:29.084507 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:31:29.085537 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m23:31:29.105819 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m23:31:29.116437 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:31:29.117556 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m23:31:29.119092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:29.124641 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:31:29.126459 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m23:31:29.128867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:29.175963 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:31:29.177573 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:31:29.178629 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:31:29.184385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:31:29.195807 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m23:31:29.204307 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:31:29.205710 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m23:31:29.213383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:31:29.216423 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 23:31:28.999643 => 23:31:29.216062
[0m23:31:29.217433 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m23:31:29.218979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b78215fef0>]}
[0m23:31:29.220680 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.25s]
[0m23:31:29.222325 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m23:31:29.223887 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m23:31:29.225740 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m23:31:29.227187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m23:31:29.228294 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m23:31:29.232446 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m23:31:29.253858 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 23:31:29.229040 => 23:31:29.253448
[0m23:31:29.254821 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m23:31:29.261525 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m23:31:29.280634 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:31:29.281649 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m23:31:29.282574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:29.289859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:31:29.291846 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:31:29.293054 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m23:31:29.310811 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m23:31:29.315148 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:31:29.316309 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m23:31:29.317826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:29.321873 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:31:29.323218 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m23:31:29.325431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:29.328505 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:31:29.329467 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:31:29.330419 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:31:29.338249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:31:29.344143 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m23:31:29.345873 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:31:29.347189 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m23:31:29.354446 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:31:29.358448 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 23:31:29.255618 => 23:31:29.358010
[0m23:31:29.359634 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m23:31:29.361967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b782186120>]}
[0m23:31:29.363603 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.13s]
[0m23:31:29.365196 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m23:31:29.366342 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m23:31:29.367860 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m23:31:29.369442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m23:31:29.370591 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m23:31:29.376422 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m23:31:29.396652 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 23:31:29.371471 => 23:31:29.396137
[0m23:31:29.397861 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m23:31:29.404498 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m23:31:29.425168 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:31:29.426748 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m23:31:29.428306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:29.436810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:31:29.438089 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:31:29.439857 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m23:31:29.459442 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m23:31:29.467162 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:31:29.468726 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m23:31:29.470606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:29.478900 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:31:29.480400 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m23:31:29.482250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:29.485667 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:31:29.486712 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:31:29.488016 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:31:29.495625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:31:29.500208 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m23:31:29.501871 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:31:29.503101 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m23:31:29.509439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:31:29.512625 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 23:31:29.398753 => 23:31:29.512285
[0m23:31:29.513929 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m23:31:29.516577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fd83cf-8532-4928-b0cb-5787e85ea7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7821bbd10>]}
[0m23:31:29.519278 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.15s]
[0m23:31:29.521462 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m23:31:29.526224 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:29.527686 [debug] [MainThread]: On master: BEGIN
[0m23:31:29.529264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:29.539183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:31:29.541083 [debug] [MainThread]: On master: COMMIT
[0m23:31:29.542916 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:29.545546 [debug] [MainThread]: On master: COMMIT
[0m23:31:29.547607 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:31:29.549531 [debug] [MainThread]: On master: Close
[0m23:31:29.552134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:29.553900 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m23:31:29.555897 [info ] [MainThread]: 
[0m23:31:29.559245 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m23:31:29.562594 [debug] [MainThread]: Command end result
[0m23:31:29.652286 [info ] [MainThread]: 
[0m23:31:29.653958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:29.655617 [info ] [MainThread]: 
[0m23:31:29.657623 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:31:29.660927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b783aae810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b78408ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7821bbd10>]}
[0m23:31:29.664779 [debug] [MainThread]: Flushing usage events
[0m23:41:45.871101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e3092b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e31c7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e3512270>]}


============================== 23:41:45.876861 | e84ddb60-7771-4a60-8fda-9bbf2cd670f8 ==============================
[0m23:41:45.876861 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:41:45.878093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:41:46.148314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e257a720>]}
[0m23:41:46.263716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e3190ef0>]}
[0m23:41:46.265690 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m23:41:46.294345 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:41:46.536900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:46.538109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:46.540507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m23:41:46.547478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e257b020>]}
[0m23:41:46.596488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e1d694c0>]}
[0m23:41:46.597488 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:41:46.598431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e30beae0>]}
[0m23:41:46.601168 [info ] [MainThread]: 
[0m23:41:46.602636 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:46.605322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m23:41:46.618906 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m23:41:46.620024 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m23:41:46.621253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:46.630078 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:41:46.632302 [debug] [ThreadPool]: On list_nba: Close
[0m23:41:46.635536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m23:41:46.645272 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:41:46.646256 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m23:41:46.647149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:46.654075 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:41:46.655857 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m23:41:46.656925 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m23:41:46.661503 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:41:46.663716 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m23:41:46.665084 [debug] [ThreadPool]: On list_nba_raw: Close
[0m23:41:46.673017 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:46.674058 [debug] [MainThread]: On master: BEGIN
[0m23:41:46.674923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:46.681961 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:46.683068 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:46.684092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:46.696037 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:41:46.698005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e190fbf0>]}
[0m23:41:46.699027 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:46.700371 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:46.701257 [debug] [MainThread]: On master: BEGIN
[0m23:41:46.703011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:46.704124 [debug] [MainThread]: On master: COMMIT
[0m23:41:46.705579 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:46.706710 [debug] [MainThread]: On master: COMMIT
[0m23:41:46.708080 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:41:46.709018 [debug] [MainThread]: On master: Close
[0m23:41:46.710467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:46.711554 [info ] [MainThread]: 
[0m23:41:46.716627 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m23:41:46.717879 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m23:41:46.719320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m23:41:46.720323 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m23:41:46.730198 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m23:41:46.750446 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 23:41:46.721432 => 23:41:46.750040
[0m23:41:46.751372 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m23:41:46.800638 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m23:41:46.822122 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:41:46.823279 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m23:41:46.824275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:46.831008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:46.832218 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:41:46.833221 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m23:41:46.848204 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m23:41:46.857042 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:41:46.858174 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m23:41:46.859887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:46.864101 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:41:46.865150 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m23:41:46.866703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:46.892546 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:41:46.893661 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:41:46.894593 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m23:41:46.907689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:41:46.915898 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m23:41:46.924408 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m23:41:46.925648 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m23:41:46.932513 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:41:46.935176 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 23:41:46.752036 => 23:41:46.934871
[0m23:41:46.936198 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m23:41:46.937967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e19c44a0>]}
[0m23:41:46.939631 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.22s]
[0m23:41:46.941150 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m23:41:46.942339 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m23:41:46.943400 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m23:41:46.944867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m23:41:46.945824 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m23:41:46.950095 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m23:41:46.969850 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 23:41:46.946668 => 23:41:46.969440
[0m23:41:46.971695 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m23:41:46.977592 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m23:41:46.996323 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:41:46.997267 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m23:41:46.998133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:47.006444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:47.007512 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:41:47.008638 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m23:41:47.026557 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m23:41:47.030982 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:41:47.032055 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m23:41:47.033556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:47.038261 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:41:47.039421 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m23:41:47.040923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:47.043919 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:41:47.045000 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:41:47.046002 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m23:41:47.053116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:41:47.062479 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m23:41:47.065730 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m23:41:47.068103 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m23:41:47.077861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:41:47.083828 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 23:41:46.972984 => 23:41:47.082995
[0m23:41:47.085928 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m23:41:47.090725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e19c3e30>]}
[0m23:41:47.094603 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.15s]
[0m23:41:47.097790 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m23:41:47.100203 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m23:41:47.102549 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m23:41:47.105243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m23:41:47.106665 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m23:41:47.112313 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m23:41:47.133548 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 23:41:47.107665 => 23:41:47.133037
[0m23:41:47.134767 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m23:41:47.144086 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m23:41:47.164612 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:41:47.165818 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m23:41:47.166911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:47.175436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:47.176807 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:41:47.177995 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m23:41:47.195613 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m23:41:47.203406 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:41:47.204992 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m23:41:47.206945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:47.211019 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:41:47.212254 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m23:41:47.213797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:47.216868 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:41:47.217880 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:41:47.218809 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m23:41:47.224770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:41:47.228598 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m23:41:47.229943 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m23:41:47.230885 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m23:41:47.238447 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:41:47.241811 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 23:41:47.135668 => 23:41:47.241491
[0m23:41:47.242911 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m23:41:47.244967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e84ddb60-7771-4a60-8fda-9bbf2cd670f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e15656d0>]}
[0m23:41:47.246617 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.14s]
[0m23:41:47.248531 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m23:41:47.251835 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:47.253103 [debug] [MainThread]: On master: BEGIN
[0m23:41:47.254062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:47.261946 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:47.263076 [debug] [MainThread]: On master: COMMIT
[0m23:41:47.264142 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:47.265145 [debug] [MainThread]: On master: COMMIT
[0m23:41:47.266467 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:41:47.267447 [debug] [MainThread]: On master: Close
[0m23:41:47.268979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:47.269909 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m23:41:47.271065 [info ] [MainThread]: 
[0m23:41:47.272554 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m23:41:47.274322 [debug] [MainThread]: Command end result
[0m23:41:47.331192 [info ] [MainThread]: 
[0m23:41:47.332299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:47.333240 [info ] [MainThread]: 
[0m23:41:47.334187 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:41:47.335855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e343d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e254f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a0e1523da0>]}
[0m23:41:47.336956 [debug] [MainThread]: Flushing usage events
[0m21:16:43.210446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467fb41a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467fc3d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467fb419a0>]}


============================== 21:16:43.216391 | 5ab42e3e-4977-40cd-bb30-9ecb80e8ddee ==============================
[0m21:16:43.216391 [info ] [MainThread]: Running with dbt=1.7.9
[0m21:16:43.568034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:16:44.134386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467fc08d70>]}
[0m21:16:44.303318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467fa961e0>]}
[0m21:16:44.304868 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m21:16:44.334975 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m21:16:44.986173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:44.987896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:44.990627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m21:16:45.006203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467f574d10>]}
[0m21:16:45.175531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467f1c1b20>]}
[0m21:16:45.177647 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m21:16:45.179758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467ed07fe0>]}
[0m21:16:45.187770 [info ] [MainThread]: 
[0m21:16:45.191093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:45.195700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m21:16:45.224954 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m21:16:45.226464 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m21:16:45.228726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:45.268469 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:16:45.277322 [debug] [ThreadPool]: On list_nba: Close
[0m21:16:45.288570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m21:16:45.309433 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m21:16:45.314985 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m21:16:45.324010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:45.336156 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:16:45.347961 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m21:16:45.352423 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:16:45.388525 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:16:45.393453 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m21:16:45.395417 [debug] [ThreadPool]: On list_nba_raw: Close
[0m21:16:45.413644 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:45.415234 [debug] [MainThread]: On master: BEGIN
[0m21:16:45.418202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:45.427540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:45.428662 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:45.429785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:45.453147 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:16:45.456546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467fa676b0>]}
[0m21:16:45.458023 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:45.459548 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:45.460594 [debug] [MainThread]: On master: BEGIN
[0m21:16:45.462449 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:45.463481 [debug] [MainThread]: On master: COMMIT
[0m21:16:45.464443 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:45.465701 [debug] [MainThread]: On master: COMMIT
[0m21:16:45.467799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:16:45.469247 [debug] [MainThread]: On master: Close
[0m21:16:45.471948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:45.474712 [info ] [MainThread]: 
[0m21:16:45.480490 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m21:16:45.482248 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m21:16:45.485293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m21:16:45.487253 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m21:16:45.505753 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m21:16:45.523933 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 21:16:45.488569 => 21:16:45.523426
[0m21:16:45.525036 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m21:16:45.593723 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m21:16:45.614192 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:16:45.615655 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m21:16:45.617632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:45.626829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:45.628090 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:16:45.629283 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m21:16:45.672471 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m21:16:45.682889 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:16:45.684292 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m21:16:45.686145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:45.691273 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:16:45.692489 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m21:16:45.694371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:45.726601 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m21:16:45.728803 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:16:45.730435 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m21:16:45.736975 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:16:45.750058 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m21:16:45.763365 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:16:45.764792 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m21:16:45.777234 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:16:45.780475 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 21:16:45.525790 => 21:16:45.780086
[0m21:16:45.781824 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m21:16:45.784267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467e9301a0>]}
[0m21:16:45.786582 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.30s]
[0m21:16:45.789229 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m21:16:45.791078 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m21:16:45.792426 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m21:16:45.794137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m21:16:45.795458 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m21:16:45.801768 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m21:16:45.823286 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 21:16:45.796337 => 21:16:45.822781
[0m21:16:45.824668 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m21:16:45.831304 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m21:16:45.851703 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:16:45.853535 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m21:16:45.855160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:45.863563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:45.864807 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:16:45.866095 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m21:16:45.882982 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:16:45.888827 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:16:45.890055 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m21:16:45.891837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:45.897020 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:16:45.898321 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m21:16:45.900259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:45.904009 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m21:16:45.905385 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:16:45.906538 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m21:16:45.912324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:16:45.917543 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m21:16:45.919877 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:16:45.921644 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m21:16:45.930475 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:16:45.934617 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 21:16:45.825504 => 21:16:45.933902
[0m21:16:45.936751 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m21:16:45.939650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467e91ffe0>]}
[0m21:16:45.942549 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.15s]
[0m21:16:45.944338 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m21:16:45.946137 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m21:16:45.947907 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m21:16:45.950098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m21:16:45.951900 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m21:16:45.959521 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m21:16:45.981894 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 21:16:45.953526 => 21:16:45.981103
[0m21:16:45.983364 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m21:16:45.997679 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m21:16:46.019959 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:16:46.022141 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m21:16:46.023592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:46.031872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:46.033188 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:16:46.034641 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m21:16:46.054702 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:16:46.062033 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:16:46.063308 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m21:16:46.065167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:46.071346 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:16:46.073014 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m21:16:46.075121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:16:46.078678 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m21:16:46.079861 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:16:46.080884 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m21:16:46.089838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:16:46.094823 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m21:16:46.099044 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:16:46.102779 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m21:16:46.115210 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:16:46.129638 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 21:16:45.984987 => 21:16:46.127762
[0m21:16:46.137747 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m21:16:46.147084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab42e3e-4977-40cd-bb30-9ecb80e8ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467e9bf0e0>]}
[0m21:16:46.154378 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.20s]
[0m21:16:46.159542 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m21:16:46.166359 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:46.169023 [debug] [MainThread]: On master: BEGIN
[0m21:16:46.171820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:46.185186 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:46.187600 [debug] [MainThread]: On master: COMMIT
[0m21:16:46.189757 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:46.191707 [debug] [MainThread]: On master: COMMIT
[0m21:16:46.194509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:16:46.196327 [debug] [MainThread]: On master: Close
[0m21:16:46.198881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:46.201669 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m21:16:46.204154 [info ] [MainThread]: 
[0m21:16:46.206734 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m21:16:46.210576 [debug] [MainThread]: Command end result
[0m21:16:46.315453 [info ] [MainThread]: 
[0m21:16:46.318136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:46.320065 [info ] [MainThread]: 
[0m21:16:46.321764 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:16:46.324565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764684452ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467e9afc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76467e988470>]}
[0m21:16:46.326274 [debug] [MainThread]: Flushing usage events
[0m21:21:53.503761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931f05259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931f14a3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931f1522270>]}


============================== 21:21:53.511708 | 1a495db1-56b5-4c1b-8dd6-f901208071fa ==============================
[0m21:21:53.511708 [info ] [MainThread]: Running with dbt=1.7.9
[0m21:21:53.513178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:21:53.879034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931efd790d0>]}
[0m21:21:54.204687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931f182ade0>]}
[0m21:21:54.207656 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m21:21:54.261077 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m21:21:54.623679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:54.625022 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:54.627055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m21:21:54.640636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931efdc2270>]}
[0m21:21:54.700872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931ef561700>]}
[0m21:21:54.703034 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m21:21:54.705538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931f0557080>]}
[0m21:21:54.709768 [info ] [MainThread]: 
[0m21:21:54.711861 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:54.715373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m21:21:54.746081 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m21:21:54.751071 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m21:21:54.753717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:54.768066 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:21:54.771738 [debug] [ThreadPool]: On list_nba: Close
[0m21:21:54.777671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m21:21:54.793450 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m21:21:54.795420 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m21:21:54.797372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:54.809068 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:21:54.810792 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m21:21:54.812561 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:21:54.823953 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:21:54.830722 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m21:21:54.834547 [debug] [ThreadPool]: On list_nba_raw: Close
[0m21:21:54.862592 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:54.866197 [debug] [MainThread]: On master: BEGIN
[0m21:21:54.879891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:54.900551 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:21:54.913032 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:54.917520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:54.965599 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:21:54.970733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931efd4f830>]}
[0m21:21:54.975518 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:54.978742 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:54.983301 [debug] [MainThread]: On master: BEGIN
[0m21:21:54.988863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:21:54.997832 [debug] [MainThread]: On master: COMMIT
[0m21:21:55.000853 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:55.008982 [debug] [MainThread]: On master: COMMIT
[0m21:21:55.011876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:21:55.015114 [debug] [MainThread]: On master: Close
[0m21:21:55.018542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:55.020512 [info ] [MainThread]: 
[0m21:21:55.045716 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m21:21:55.067785 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m21:21:55.086933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m21:21:55.096328 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m21:21:55.134740 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m21:21:55.173201 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 21:21:55.098729 => 21:21:55.172363
[0m21:21:55.175887 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m21:21:55.343257 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m21:21:55.408889 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:21:55.411336 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m21:21:55.413097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:55.427915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:21:55.430091 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:21:55.431998 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m21:21:55.476904 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m21:21:55.512980 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:21:55.515810 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m21:21:55.519765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:21:55.545062 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:21:55.549836 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m21:21:55.554825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:21:55.645561 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m21:21:55.648189 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:21:55.649438 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m21:21:55.656784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:21:55.668801 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m21:21:55.683544 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:21:55.685083 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m21:21:55.693477 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:21:55.697654 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 21:21:55.177141 => 21:21:55.697047
[0m21:21:55.699181 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m21:21:55.701339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931ef1c4650>]}
[0m21:21:55.702958 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.62s]
[0m21:21:55.704901 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m21:21:55.706379 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m21:21:55.708064 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m21:21:55.710113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m21:21:55.711445 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m21:21:55.718053 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m21:21:55.737632 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 21:21:55.712508 => 21:21:55.737003
[0m21:21:55.738776 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m21:21:55.745915 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m21:21:55.772104 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:21:55.773817 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m21:21:55.775438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:55.785275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:21:55.787029 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:21:55.789441 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m21:21:55.813594 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:21:55.819535 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:21:55.821144 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m21:21:55.823138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:21:55.829887 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:21:55.831220 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m21:21:55.834136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:21:55.839510 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m21:21:55.841058 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:21:55.842522 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m21:21:55.849663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:21:55.855043 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m21:21:55.857759 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:21:55.859354 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m21:21:55.868012 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:21:55.872121 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 21:21:55.739763 => 21:21:55.871492
[0m21:21:55.873748 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m21:21:55.876654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931eed121e0>]}
[0m21:21:55.878687 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.17s]
[0m21:21:55.881536 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m21:21:55.883663 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m21:21:55.886050 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m21:21:55.889075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m21:21:55.890898 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m21:21:55.899612 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m21:21:55.920448 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 21:21:55.891966 => 21:21:55.919623
[0m21:21:55.922192 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m21:21:55.931709 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m21:21:55.953078 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:21:55.955163 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m21:21:55.957167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:55.968352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:21:55.970675 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:21:55.972909 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m21:21:55.999645 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:21:56.015342 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:21:56.017683 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m21:21:56.020384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:21:56.031061 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:21:56.033729 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m21:21:56.036353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:21:56.044457 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m21:21:56.049702 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:21:56.054568 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m21:21:56.077745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:21:56.086378 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m21:21:56.092637 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:21:56.094226 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m21:21:56.101481 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:21:56.104464 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 21:21:55.923271 => 21:21:56.104045
[0m21:21:56.106108 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m21:21:56.108904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a495db1-56b5-4c1b-8dd6-f901208071fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931eed5f170>]}
[0m21:21:56.110477 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.22s]
[0m21:21:56.112216 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m21:21:56.116153 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:56.117369 [debug] [MainThread]: On master: BEGIN
[0m21:21:56.118509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:56.129857 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:21:56.131699 [debug] [MainThread]: On master: COMMIT
[0m21:21:56.133103 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:56.134613 [debug] [MainThread]: On master: COMMIT
[0m21:21:56.136757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:21:56.138614 [debug] [MainThread]: On master: Close
[0m21:21:56.141763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:56.144101 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m21:21:56.151250 [info ] [MainThread]: 
[0m21:21:56.153337 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m21:21:56.157352 [debug] [MainThread]: Command end result
[0m21:21:56.246334 [info ] [MainThread]: 
[0m21:21:56.247681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:21:56.248853 [info ] [MainThread]: 
[0m21:21:56.250540 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:21:56.252822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931f08ab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931f4e62f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931eed5df70>]}
[0m21:21:56.254056 [debug] [MainThread]: Flushing usage events
[0m21:30:37.920573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7e1f5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7de1eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7de1d1c0>]}


============================== 21:30:37.926431 | 683164af-e44b-4cdf-b1cc-4502c45b3f47 ==============================
[0m21:30:37.926431 [info ] [MainThread]: Running with dbt=1.7.9
[0m21:30:37.928012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:38.284397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7d502720>]}
[0m21:30:38.462302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7d907b00>]}
[0m21:30:38.464323 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m21:30:38.492899 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m21:30:38.808568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:38.809982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:38.811349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m21:30:38.819641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7d96c560>]}
[0m21:30:38.882559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7d1752b0>]}
[0m21:30:38.883902 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m21:30:38.885057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7d8df590>]}
[0m21:30:38.888348 [info ] [MainThread]: 
[0m21:30:38.890196 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:38.892799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m21:30:38.909213 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m21:30:38.910585 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m21:30:38.911715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:38.939281 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:30:38.946447 [debug] [ThreadPool]: On list_nba: Close
[0m21:30:38.958776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m21:30:38.986177 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m21:30:38.989109 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m21:30:38.992159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:39.013788 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:39.017573 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m21:30:39.021328 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:30:39.047875 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:30:39.055256 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m21:30:39.059144 [debug] [ThreadPool]: On list_nba_raw: Close
[0m21:30:39.083694 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:39.086713 [debug] [MainThread]: On master: BEGIN
[0m21:30:39.089642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:39.110502 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:39.113448 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:39.116895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:39.168131 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:30:39.175054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7d167c80>]}
[0m21:30:39.178459 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:39.182294 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:39.185644 [debug] [MainThread]: On master: BEGIN
[0m21:30:39.190668 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:39.193840 [debug] [MainThread]: On master: COMMIT
[0m21:30:39.196595 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:39.199798 [debug] [MainThread]: On master: COMMIT
[0m21:30:39.203868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:39.206791 [debug] [MainThread]: On master: Close
[0m21:30:39.211617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:39.214649 [info ] [MainThread]: 
[0m21:30:39.228579 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m21:30:39.232529 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m21:30:39.237318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m21:30:39.240747 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m21:30:39.275115 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m21:30:39.310607 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 21:30:39.243175 => 21:30:39.309803
[0m21:30:39.312632 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m21:30:39.383166 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m21:30:39.404718 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:30:39.405933 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m21:30:39.406997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:39.414430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:39.415824 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:30:39.416962 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m21:30:39.442743 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m21:30:39.452580 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:30:39.454140 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m21:30:39.456010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:39.460983 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:30:39.462365 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m21:30:39.464083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:39.516055 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m21:30:39.519401 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:30:39.522839 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m21:30:39.536606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:39.567308 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m21:30:39.599455 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m21:30:39.604151 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m21:30:39.616469 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:39.621968 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 21:30:39.314306 => 21:30:39.621289
[0m21:30:39.624000 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m21:30:39.627286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7cdcbda0>]}
[0m21:30:39.632366 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.39s]
[0m21:30:39.635151 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m21:30:39.637650 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m21:30:39.639880 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m21:30:39.642596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m21:30:39.644783 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m21:30:39.653825 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m21:30:39.687319 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 21:30:39.646179 => 21:30:39.686042
[0m21:30:39.689613 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m21:30:39.700878 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m21:30:39.734225 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:30:39.736249 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m21:30:39.738150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:39.750663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:39.752804 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:30:39.754832 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m21:30:39.778839 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:30:39.787970 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:30:39.789855 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m21:30:39.792714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:39.801610 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:30:39.803669 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m21:30:39.806458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:39.812387 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m21:30:39.814559 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:30:39.816222 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m21:30:39.829263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:39.836993 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m21:30:39.839872 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m21:30:39.841651 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m21:30:39.850895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:39.855826 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 21:30:39.691079 => 21:30:39.855189
[0m21:30:39.857611 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m21:30:39.860552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7cdfb9b0>]}
[0m21:30:39.864754 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.22s]
[0m21:30:39.867202 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m21:30:39.869559 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m21:30:39.871663 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m21:30:39.874226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m21:30:39.876563 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m21:30:39.885288 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m21:30:39.917175 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 21:30:39.878169 => 21:30:39.916451
[0m21:30:39.919040 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m21:30:39.930602 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m21:30:39.962957 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:30:39.965046 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m21:30:39.967703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:39.980032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:39.981989 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:30:39.984141 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m21:30:40.011655 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m21:30:40.024934 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:30:40.026892 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m21:30:40.029830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:40.038858 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:30:40.040942 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m21:30:40.044021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:40.050192 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m21:30:40.052461 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:30:40.054450 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m21:30:40.063290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:40.073075 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m21:30:40.076059 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m21:30:40.078073 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m21:30:40.089509 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:40.094459 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 21:30:39.920626 => 21:30:40.093880
[0m21:30:40.096383 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m21:30:40.100076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683164af-e44b-4cdf-b1cc-4502c45b3f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7c973e90>]}
[0m21:30:40.103590 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.23s]
[0m21:30:40.106974 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m21:30:40.113532 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:40.115361 [debug] [MainThread]: On master: BEGIN
[0m21:30:40.117387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:40.130548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:40.132809 [debug] [MainThread]: On master: COMMIT
[0m21:30:40.134535 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:40.136606 [debug] [MainThread]: On master: COMMIT
[0m21:30:40.139176 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:40.141208 [debug] [MainThread]: On master: Close
[0m21:30:40.144117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:40.146172 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m21:30:40.147992 [info ] [MainThread]: 
[0m21:30:40.149943 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m21:30:40.153824 [debug] [MainThread]: Command end result
[0m21:30:40.260748 [info ] [MainThread]: 
[0m21:30:40.263930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:40.266447 [info ] [MainThread]: 
[0m21:30:40.269091 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:30:40.273051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.452289, "process_user_time": 4.833524, "process_kernel_time": 0.618659, "process_mem_max_rss": "200932", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:40.275203 [debug] [MainThread]: Command `dbt run` succeeded at 21:30:40.274771 after 2.45 seconds
[0m21:30:40.277795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7def6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7c941f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7c941e80>]}
[0m21:30:40.281084 [debug] [MainThread]: Flushing usage events
[0m14:20:52.488947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540b573ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540b572a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540b572630>]}


============================== 14:20:52.493489 | 2ab8d449-aeb3-403b-8c41-d0115927ef22 ==============================
[0m14:20:52.493489 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:20:52.494655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:20:52.987636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540af3d550>]}
[0m14:20:53.159704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540c86dca0>]}
[0m14:20:53.546776 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m14:20:53.576863 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:20:54.405426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:54.407139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:54.408559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spurs_analysis
[0m14:20:54.424437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540ab64b00>]}
[0m14:20:54.505213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540a709190>]}
[0m14:20:54.507152 [info ] [MainThread]: Found 3 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:20:54.509011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540b446360>]}
[0m14:20:54.514886 [info ] [MainThread]: 
[0m14:20:54.519542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:54.523544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nba'
[0m14:20:54.557004 [debug] [ThreadPool]: Using postgres connection "list_nba"
[0m14:20:54.558176 [debug] [ThreadPool]: On list_nba: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba"} */

    select distinct nspname from pg_namespace
  
[0m14:20:54.559449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:54.586090 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:20:54.589261 [debug] [ThreadPool]: On list_nba: Close
[0m14:20:54.594397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nba, now list_nba_raw)
[0m14:20:54.605563 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m14:20:54.607240 [debug] [ThreadPool]: On list_nba_raw: BEGIN
[0m14:20:54.608366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:54.616501 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:20:54.618479 [debug] [ThreadPool]: Using postgres connection "list_nba_raw"
[0m14:20:54.620010 [debug] [ThreadPool]: On list_nba_raw: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "list_nba_raw"} */
select
      'nba' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'nba' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m14:20:54.641565 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:20:54.645425 [debug] [ThreadPool]: On list_nba_raw: ROLLBACK
[0m14:20:54.646927 [debug] [ThreadPool]: On list_nba_raw: Close
[0m14:20:54.660860 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:54.662044 [debug] [MainThread]: On master: BEGIN
[0m14:20:54.663491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:54.674533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:20:54.675550 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:54.676634 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:20:54.718164 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:20:54.720588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540a70b590>]}
[0m14:20:54.722131 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:54.723593 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:54.724531 [debug] [MainThread]: On master: BEGIN
[0m14:20:54.726317 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:20:54.727499 [debug] [MainThread]: On master: COMMIT
[0m14:20:54.728465 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:54.729344 [debug] [MainThread]: On master: COMMIT
[0m14:20:54.730515 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:20:54.733818 [debug] [MainThread]: On master: Close
[0m14:20:54.735803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:54.738763 [info ] [MainThread]: 
[0m14:20:54.745214 [debug] [Thread-1 (]: Began running node model.spurs_dbt.home_vs_away
[0m14:20:54.746896 [info ] [Thread-1 (]: 1 of 3 START sql table model raw.home_vs_away .................................. [RUN]
[0m14:20:54.751860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nba_raw, now model.spurs_dbt.home_vs_away)
[0m14:20:54.754407 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.home_vs_away
[0m14:20:54.771806 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.home_vs_away"
[0m14:20:54.791622 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (compile): 14:20:54.755922 => 14:20:54.791097
[0m14:20:54.792744 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.home_vs_away
[0m14:20:54.878305 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.home_vs_away"
[0m14:20:54.905566 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m14:20:54.907315 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: BEGIN
[0m14:20:54.908523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:54.917852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:20:54.919552 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m14:20:54.920774 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */

  
    

  create  table "nba"."raw"."home_vs_away__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    case
      when matchup like '%@%' then 'Away'
      else 'Home'
    end as location,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  location,
  count(*) as games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season, location
order by season, location
  );
  
[0m14:20:55.030267 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m14:20:55.045587 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m14:20:55.046795 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away" rename to "home_vs_away__dbt_backup"
[0m14:20:55.056303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:20:55.062988 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m14:20:55.065910 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
alter table "nba"."raw"."home_vs_away__dbt_tmp" rename to "home_vs_away"
[0m14:20:55.068964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:20:55.108021 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m14:20:55.110923 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m14:20:55.112207 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: COMMIT
[0m14:20:55.122774 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:20:55.139634 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."home_vs_away__dbt_backup"
[0m14:20:55.152357 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.home_vs_away"
[0m14:20:55.153363 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.home_vs_away"} */
drop table if exists "nba"."raw"."home_vs_away__dbt_backup" cascade
[0m14:20:55.171449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:20:55.174819 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.home_vs_away (execute): 14:20:54.793503 => 14:20:55.174443
[0m14:20:55.175819 [debug] [Thread-1 (]: On model.spurs_dbt.home_vs_away: Close
[0m14:20:55.177531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540a3292e0>]}
[0m14:20:55.179253 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw.home_vs_away ............................. [[32mSELECT 20[0m in 0.43s]
[0m14:20:55.276811 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.home_vs_away
[0m14:20:55.278487 [debug] [Thread-1 (]: Began running node model.spurs_dbt.summary_by_season
[0m14:20:55.280460 [info ] [Thread-1 (]: 2 of 3 START sql table model raw.summary_by_season ............................. [RUN]
[0m14:20:55.283727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.home_vs_away, now model.spurs_dbt.summary_by_season)
[0m14:20:55.285315 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.summary_by_season
[0m14:20:55.291153 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.summary_by_season"
[0m14:20:55.311296 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (compile): 14:20:55.286415 => 14:20:55.310849
[0m14:20:55.312448 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.summary_by_season
[0m14:20:55.323932 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.summary_by_season"
[0m14:20:55.350334 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m14:20:55.351997 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: BEGIN
[0m14:20:55.353185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:55.361384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:20:55.362541 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m14:20:55.365534 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */

  
    

  create  table "nba"."raw"."summary_by_season__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    wl,
    pts::int as pts
  from "nba"."raw"."spurs_games"
)

select
  season,
  count(*) as total_games,
  sum(case when wl = 'W' then 1 else 0 end) as wins,
  sum(case when wl = 'L' then 1 else 0 end) as losses,
  round(avg(pts), 2) as avg_points
from base
group by season
order by season
  );
  
[0m14:20:55.385669 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m14:20:55.394487 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m14:20:55.403457 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season" rename to "summary_by_season__dbt_backup"
[0m14:20:55.406939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:20:55.419400 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m14:20:55.421528 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
alter table "nba"."raw"."summary_by_season__dbt_tmp" rename to "summary_by_season"
[0m14:20:55.426767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:20:55.436941 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m14:20:55.439030 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m14:20:55.442150 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: COMMIT
[0m14:20:55.453904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:20:55.465188 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."summary_by_season__dbt_backup"
[0m14:20:55.468328 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.summary_by_season"
[0m14:20:55.470187 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.summary_by_season"} */
drop table if exists "nba"."raw"."summary_by_season__dbt_backup" cascade
[0m14:20:55.479415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:20:55.488356 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.summary_by_season (execute): 14:20:55.314773 => 14:20:55.487422
[0m14:20:55.490587 [debug] [Thread-1 (]: On model.spurs_dbt.summary_by_season: Close
[0m14:20:55.493602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540a3619a0>]}
[0m14:20:55.498629 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw.summary_by_season ........................ [[32mSELECT 10[0m in 0.21s]
[0m14:20:55.502373 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.summary_by_season
[0m14:20:55.505088 [debug] [Thread-1 (]: Began running node model.spurs_dbt.team_weaknesses
[0m14:20:55.507073 [info ] [Thread-1 (]: 3 of 3 START sql table model raw.team_weaknesses ............................... [RUN]
[0m14:20:55.509515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spurs_dbt.summary_by_season, now model.spurs_dbt.team_weaknesses)
[0m14:20:55.510839 [debug] [Thread-1 (]: Began compiling node model.spurs_dbt.team_weaknesses
[0m14:20:55.524861 [debug] [Thread-1 (]: Writing injected SQL for node "model.spurs_dbt.team_weaknesses"
[0m14:20:55.571121 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (compile): 14:20:55.512056 => 14:20:55.570121
[0m14:20:55.572849 [debug] [Thread-1 (]: Began executing node model.spurs_dbt.team_weaknesses
[0m14:20:55.590590 [debug] [Thread-1 (]: Writing runtime sql for node "model.spurs_dbt.team_weaknesses"
[0m14:20:55.625447 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m14:20:55.627129 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: BEGIN
[0m14:20:55.628820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:55.642595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:20:55.644468 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m14:20:55.653462 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */

  
    

  create  table "nba"."raw"."team_weaknesses__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    season,
    fg_pct::float as fg_pct,
    tov::int as turnovers
  from "nba"."raw"."spurs_games"
)

select
  season,
   round(avg(fg_pct)::numeric, 3) as avg_fg_pct,
  round(avg(turnovers), 2) as avg_turnovers
from base
group by season
having round(avg(fg_pct)::numeric, 3) < 0.45 or round(avg(turnovers), 2) > 14
order by season
  );
  
[0m14:20:55.692978 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:20:55.718376 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m14:20:55.730380 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses" rename to "team_weaknesses__dbt_backup"
[0m14:20:55.734618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:20:55.756197 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m14:20:55.760268 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
alter table "nba"."raw"."team_weaknesses__dbt_tmp" rename to "team_weaknesses"
[0m14:20:55.766904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:20:55.771894 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m14:20:55.773327 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m14:20:55.775914 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: COMMIT
[0m14:20:55.787354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:20:55.795649 [debug] [Thread-1 (]: Applying DROP to: "nba"."raw"."team_weaknesses__dbt_backup"
[0m14:20:55.801651 [debug] [Thread-1 (]: Using postgres connection "model.spurs_dbt.team_weaknesses"
[0m14:20:55.805939 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "spurs_profile", "target_name": "dev", "node_id": "model.spurs_dbt.team_weaknesses"} */
drop table if exists "nba"."raw"."team_weaknesses__dbt_backup" cascade
[0m14:20:55.814463 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:20:55.817787 [debug] [Thread-1 (]: Timing info for model.spurs_dbt.team_weaknesses (execute): 14:20:55.574353 => 14:20:55.817502
[0m14:20:55.819338 [debug] [Thread-1 (]: On model.spurs_dbt.team_weaknesses: Close
[0m14:20:55.821139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab8d449-aeb3-403b-8c41-d0115927ef22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540a3b2870>]}
[0m14:20:55.823090 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw.team_weaknesses .......................... [[32mSELECT 2[0m in 0.31s]
[0m14:20:55.825385 [debug] [Thread-1 (]: Finished running node model.spurs_dbt.team_weaknesses
[0m14:20:55.830909 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:55.836002 [debug] [MainThread]: On master: BEGIN
[0m14:20:55.837854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:55.848070 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:20:55.849522 [debug] [MainThread]: On master: COMMIT
[0m14:20:55.851017 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:55.852475 [debug] [MainThread]: On master: COMMIT
[0m14:20:55.854545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:20:55.855928 [debug] [MainThread]: On master: Close
[0m14:20:55.857725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:55.859469 [debug] [MainThread]: Connection 'model.spurs_dbt.team_weaknesses' was properly closed.
[0m14:20:55.865502 [info ] [MainThread]: 
[0m14:20:55.866683 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m14:20:55.869012 [debug] [MainThread]: Command end result
[0m14:20:55.939041 [info ] [MainThread]: 
[0m14:20:55.940832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:55.942004 [info ] [MainThread]: 
[0m14:20:55.943159 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:20:55.949068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5698059, "process_user_time": 5.899141, "process_kernel_time": 0.896278, "process_mem_max_rss": "200816", "process_in_blocks": "26488", "process_out_blocks": "0"}
[0m14:20:55.951101 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:55.950618 after 3.57 seconds
[0m14:20:55.953758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540c2f1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540c26e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d540ff06f60>]}
[0m14:20:55.958651 [debug] [MainThread]: Flushing usage events
